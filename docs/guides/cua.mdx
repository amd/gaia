---
title: "Computer Use Agent"
description: "AI-powered desktop control through natural language commands"
---

<Info>
  **Source Code:** [`src/gaia/agents/cua/agent.py`](https://github.com/amd/gaia/blob/main/src/gaia/agents/cua/agent.py)
</Info>

## Overview

The Computer Use Agent (CUA) enables AI-powered desktop control through natural language commands.
It connects to external MCP servers that provide desktop automation capabilities (like clicking,
typing, scrolling) and uses Lemonade for intelligent reasoning about which actions to take.

### Key Features

- **Natural language control** - Tell the agent what you want, it figures out how
- **Dynamic tool discovery** - Automatically discovers available tools from external MCP servers
- **Multiple connection modes** - Supports both stdio and HTTP connections
- **Lemonade-powered reasoning** - Uses Qwen-Coder 30B for intelligent decision making
- **Extensible architecture** - Easy to add support for new MCP servers

## Quick Start

### Prerequisites

1. **Lemonade Server** running with Qwen-Coder 30B model
2. **External MCP Server** for desktop control (e.g., CursorTouch Windows-MCP)

```bash
# Install Lemonade Server (if not already installed)
pip install lemonade-server

# Start Lemonade
lemonade-server serve
```

### Start External MCP Server

```bash
# Install and run CursorTouch Windows-MCP (example)
uvx windows-mcp
```

### Run CUA

```bash
# Single command
python -m gaia.agents.cua.cli "click on the Start menu"

# List available tools
python -m gaia.agents.cua.cli --list-tools

# With verbose output
python -m gaia.agents.cua.cli "type hello world" --verbose
```

## Architecture

The Computer Use Agent wraps external MCP servers and provides AI-powered control:

```
┌──────────────────────────────────────────────────────────┐
│  User: "click on the Start menu"                          │
└─────────────────────────┬────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│  ComputerUseAgent                                        │
│  - Receives natural language command                     │
│  - Sends to Lemonade with available tools                │
│  - Executes tool calls via external MCP server           │
└─────────────────────────┬───────────────────────────────┘
                          │
          ┌───────────────┴───────────────┐
          │                               │
          ▼                               ▼
┌─────────────────────┐     ┌─────────────────────────────┐
│  Lemonade           │     │  External MCP Server        │
│  (Qwen-Coder 30B)   │     │  (CursorTouch Windows-MCP)  │
│  - Reasoning        │     │  - click, type, scroll      │
│  - Tool selection   │     │  - Desktop automation       │
└─────────────────────┘     └─────────────────────────────┘
```

### How It Works

1. **User provides natural language command** - e.g., "click on the Start menu"
2. **Agent connects to external MCP server** - Discovers available tools
3. **Tools are registered locally** - Using GAIA's `@tool` decorator system
4. **Query sent to Lemonade** - With system prompt and tool descriptions
5. **Lemonade decides which tool to call** - Based on the command
6. **Agent executes tool** - Proxies call to external MCP server via JSON-RPC
7. **Result fed back to Lemonade** - For next step or final response
8. **User receives result** - Task completed message

## Configuration

### Environment Variables

Configure the external MCP server connection:

| Variable | Default | Description |
|----------|---------|-------------|
| `GAIA_CUA_MCP_URL` | `stdio` | External MCP server URL |
| `GAIA_CUA_STDIO_CMD` | `uvx windows-mcp` | Command to spawn for stdio mode |

### Connection Modes

<Tabs>
  <Tab title="stdio (Default)">
    Connects to external MCP server via stdin/stdout:

    ```bash
    export GAIA_CUA_MCP_URL=stdio
    export GAIA_CUA_STDIO_CMD="uvx windows-mcp"
    python -m gaia.agents.cua.cli "click on OK button"
    ```
  </Tab>
  <Tab title="HTTP">
    Connects to external MCP server via HTTP endpoint:

    ```bash
    export GAIA_CUA_MCP_URL=http://localhost:9000
    python -m gaia.agents.cua.cli "click on OK button"
    ```
  </Tab>
</Tabs>

## Command Reference

### CLI Options

| Option | Description |
|--------|-------------|
| `command` | Natural language command to execute |
| `--list-tools` | List available tools from external server |
| `--mcp-server-url URL` | External MCP server URL (overrides env var) |
| `--model MODEL` | LLM model ID (default: Qwen3-Coder-30B) |
| `--verbose`, `-v` | Enable verbose output with technical details |
| `--silent`, `-s` | Suppress agent step output |
| `--trace` | Show detailed execution trace |

### Examples

```bash
# Basic command
python -m gaia.agents.cua.cli "click the Start menu"

# List available tools
python -m gaia.agents.cua.cli --list-tools

# With verbose output
python -m gaia.agents.cua.cli "type hello world" --verbose

# Using HTTP connection
python -m gaia.agents.cua.cli --mcp-server-url http://localhost:9000 "scroll down"

# With trace for debugging
python -m gaia.agents.cua.cli "wait for 2 seconds" --trace
```

## External MCP Servers

The CUA agent can work with any MCP server that provides desktop control tools. Here are some examples:

### CursorTouch Windows-MCP

Desktop control for Windows:

```bash
# Install and run
uvx windows-mcp
```

**Available Tools:**
- `click(x, y)` - Click at screen coordinates
- `type(text)` - Type text
- `scroll(direction, amount)` - Scroll up/down
- `wait(seconds)` - Wait for specified time
- `screenshot()` - Capture screenshot

### Custom MCP Servers

You can create your own MCP server for custom desktop automation. See the [MCP Infrastructure Guide](/sdk/infrastructure/mcp) for details.

## Programmatic Usage

Use the CUA agent in your Python code:

```python
from gaia.agents.cua import ComputerUseAgent

# Initialize agent
agent = ComputerUseAgent(
    mcp_server_url="stdio",  # or "http://localhost:9000"
    verbose=True
)

# Check server availability
if not agent._server_available:
    print("External MCP server not available")
    exit(1)

# Execute command
result = agent.process_query("click on the Start menu")

if result.get("status") == "success":
    print(f"Success: {result.get('result')}")
else:
    print(f"Failed: {result.get('result')}")
```

## Troubleshooting

<AccordionGroup>
  <Accordion title="External MCP server not available">
    **Error:** `External MCP server is not available`

    **Solution:** Ensure the external MCP server is running:

    ```bash
    # For stdio mode
    uvx windows-mcp

    # For HTTP mode, start your HTTP server first
    ```

    Check the server URL configuration:
    ```bash
    echo $GAIA_CUA_MCP_URL
    ```
  </Accordion>

  <Accordion title="No tools discovered">
    **Symptom:** `--list-tools` returns empty or the agent says no tools available

    **Solution:** Check server connection with verbose mode:

    ```bash
    python -m gaia.agents.cua.cli --list-tools --verbose
    ```

    Verify the external MCP server is responding:
    - For stdio mode: Check that the process is running
    - For HTTP mode: Check that the endpoint is reachable (`curl http://localhost:9000/health`)
  </Accordion>

  <Accordion title="Tool execution fails">
    **Symptom:** Tools are listed but fail to execute

    **Solution:** Use `--trace` to see detailed execution:

    ```bash
    python -m gaia.agents.cua.cli "click at 100, 200" --trace
    ```

    Common issues:
    - External server crashed or hung
    - Invalid tool arguments
    - Permission issues (e.g., accessibility permissions on macOS)
  </Accordion>

  <Accordion title="Lemonade connection issues">
    **Error:** Cannot connect to Lemonade server

    **Solution:** Ensure Lemonade is running:

    ```bash
    # Check if Lemonade is running
    curl http://localhost:8000/health

    # Start Lemonade if needed
    lemonade-server serve
    ```
  </Accordion>
</AccordionGroup>

## Advanced Usage

### Multi-Step Commands

The agent can handle complex, multi-step tasks:

```bash
python -m gaia.agents.cua.cli "open the calculator app and calculate 2 + 2"
```

The agent will:
1. Reason about the steps needed
2. Execute tools in sequence (click Start, type "calculator", press Enter, type "2+2")
3. Report the final result

### Custom External Servers

Create your own MCP server for specialized automation:

```python
# custom_automation_server.py
from mcp import MCPServer

server = MCPServer()

@server.tool("custom_action")
def custom_action(param: str) -> dict:
    # Your custom desktop automation
    return {"success": True, "result": f"Executed with {param}"}

server.run()
```

Then connect CUA to it:

```bash
export GAIA_CUA_MCP_URL=http://localhost:9000
python -m gaia.agents.cua.cli "perform custom action with parameter"
```

## Future Enhancements

Planned features for CUA:

- **Multi-MCP support** - Connect to multiple external MCP servers simultaneously
- **Web UI integration** - Desktop control through OpenAI-compatible API
- **Screen understanding** - Vision model integration for intelligent clicking
- **Task recording** - Record and replay desktop automation sequences
- **Cross-platform support** - macOS, Linux desktop control servers

## Related Documentation

- [MCP Infrastructure Guide](/sdk/infrastructure/mcp) - MCP protocol details
- [API Server](/sdk/infrastructure/api-server) - OpenAI-compatible API
- [Agent System](/sdk/core/agent-system) - Base agent architecture
- [Tools](/sdk/core/tools) - Tool decorator and registry

---

<small style="color: #666;">

**License**

Copyright © 2024-2025 Advanced Micro Devices, Inc. All rights reserved.

SPDX-License-Identifier: MIT

</small>